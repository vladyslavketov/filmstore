var e={body:document.querySelector("body"),header:document.querySelector("header"),loader:document.querySelector(".loader"),modal:document.querySelector(".modal"),modalCloseBtn:document.querySelector(".backdrop .modal__close-btn"),pagination:document.querySelector("div.pagination"),btnUp:document.querySelector(".btn-up"),searchForm:document.querySelector("form.search-form"),moviesList:document.querySelector(".movies__list")};function t(){e.body.classList.remove("isLoading"),e.loader.parentElement.classList.add("isHidden")}window.addEventListener("load",(()=>{window.scrollTo(0,0),t()})),window.addEventListener("scroll",(function(){const t=window.pageYOffset;t>40?(e.body.classList.add("isScrolling"),t>500?e.btnUp.classList.remove("isHidden"):t<=500&&e.btnUp.classList.add("isHidden")):t<=40&&e.body.classList.remove("isScrolling")})),e.btnUp.addEventListener("click",(function(){window.scrollTo(0,0)}));async function i(e,t,i){let a,n="";switch(e){case"search":a="search/movie",n=`&query=${i}`;break;case"details":a=`movie/${t}`;break;case"video":a=`movie/${t}/videos`;break;case"cast":a=`movie/${t}/credits`;break;case"reviews":a=`movie/${t}/reviews`;break;case"trend":a="trending/all/week";break;case"genres":a="genre/movie/list";break;default:console.log("Invalid typeOfQuery")}const s=await fetch(`https://api.themoviedb.org/3/${a}?api_key=9cb79068ade378f45d510f1b7326cccd${n}`);return await s.json()}function a(e){const{id:t,movieTitle:i,movieImg:a,releaseYear:n,genresNamesList:s}=e;return`\n    <li class="movie-card animate__animated animate__zoomIn">\n      <img\n        class="movie-card__img"\n        src=${a}\n        alt=${i}\n        width="300"\n        height="450"\n      />\n      <div class="movie-card__desc">\n        <p class="movie-card__title">${i}</p>\n        <p class="movie-details__genres">${s}</p>\n        <p class="movie-card__year">${n}</p>\n      </div>\n      <button type="button" class="movie-card__details-btn" data-id=${t} aria-label="to open movie details"></button>\n    </li>\n  `}function n(e,t){const{id:i,title:a,name:n,poster_path:s,release_date:o,firstDate:r,genres:d}=e,l=a||n,c=`https://image.tmdb.org/t/p/w500${s}`,m=d?.map((e=>e.name)).join(", "),v=o||r;return`\n    <div class="movie-details animate__animated animate__zoomIn">\n      <img\n        class="movie-details__img"\n        src=${c}\n        alt=${l}\n      \n      />\n      <div class="movie-details__desc">\n        <p class="movie-details__title">${l}</p>\n        <p class="movie-details__desc-row movie-details__genres"><span>Genre</span>${m}</p>\n        <p class="movie-details__desc-row movie-details__year"><span>Year</span>${v?v.slice(0,4):""}</p>\n        <button type="button" class="movie-details__video-play-btn" data-id=${i} aria-label="to open movie details">Show official trailer</button>\n      </div>\n      <div class="movie-details__video isHidden">${t?` <iframe\n          src="https://www.youtube.com/embed/${t}?cc_load_policy=1?rel=0&showinfo=0&autoplay=1"\n          title="YouTube video player"\n          frameborder="0"\n          allow="accelerometer; clipboard-write; encrypted-media; gyroscope; picture-in-picture;"\n          allowfullscreen\n          autoplay="0"\n        ></iframe>`:""}</div>\n    </div>\n  `}const s=e.modal.parentElement;function o(e){e.currentTarget===e.target&&d()}function r(e){s.classList.contains("isHidden")||"Escape"===e.code&&d()}function d(){s.classList.add("isHidden"),e.body.classList.remove("modalIsOpen"),e.modal.innerHTML="",s.removeEventListener("click",o),window.removeEventListener("keydown",r),e.modalCloseBtn.removeEventListener("click",d)}e.searchForm.addEventListener("submit",(async function(e){e.preventDefault();const t=e.target.elements.searchQuery.value;v((await i("search",null,t)).results)}));let l=null;function c(t){e.modal.querySelector(".movie-details__video").classList.toggle("isHidden"),"Show official trailer"===t.target.textContent?t.target.textContent="Hide official trailer":t.target.textContent="Show official trailer"}function m(e){return e.map((e=>{const{id:t,name:i,title:a,genre_ids:n,poster_path:s,release_date:o,first_air_date:r}=e,d=a||i,c=n.map((e=>l.find((t=>e===t.id))?.name)).filter((e=>void 0!==e)).join(", ");const m=o||r;return{id:t,movieTitle:d,movieImg:`https://image.tmdb.org/t/p/w500${s}`,releaseYear:m?m.slice(0,4):"",genresNamesList:c}}))}function v(t){const i=m(t),n=(s=i,o=a,!Array.isArray(s)||!s.length>0?"Нажаль данні не завантажились( Спробуйте пізніше":s.map((e=>o(e))).join(""));var s,o;e.moviesList.innerHTML=n}!async function(){l=await async function(){return(await i("genres")).genres}();const e=await i("trend");v(e.results)}(),e.moviesList.addEventListener("click",(async function(a){if(!a.target.classList.contains("movie-card__details-btn"))return;e.body.classList.add("isLoading"),e.loader.parentElement.classList.remove("isHidden");const l=a.target.dataset.id,m=i("video",l),v=await async function(e){const{results:t}=await e;if(!t||t.length<1)return null;const i=t.find((e=>"official trailer"===e.name.toLowerCase())),a=t.find((e=>e.name.toLowerCase().includes("trailer")));return i?.key&&a?.key}(m),u=n(await i("details",l),v);e.modal.innerHTML=u,s.classList.remove("isHidden"),e.body.classList.add("modalIsOpen"),s.addEventListener("click",o),window.addEventListener("keydown",r),e.modalCloseBtn.addEventListener("click",d);const p=e.modal.querySelector(".movie-details__video-play-btn");v&&p.addEventListener("click",c),!v&&p.classList.add("isHidden"),t()}));
//# sourceMappingURL=index.aaf0983b.js.map
