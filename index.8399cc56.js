var e={body:document.querySelector("body"),header:document.querySelector("header"),loader:document.querySelector(".loader"),modal:document.querySelector(".modal"),modalCloseBtn:document.querySelector(".backdrop .modal__close-btn"),pagination:document.querySelector("div.pagination"),btnUp:document.querySelector(".btn-up"),searchForm:document.querySelector("form.search-form"),btnToTrends:document.querySelector("form .trends"),moviesList:document.querySelector(".movies__list")};function t(){e.body.classList.add("isLoading"),e.loader.parentElement.classList.remove("isHidden")}function n(){e.body.classList.remove("isLoading"),e.loader.parentElement.classList.add("isHidden")}window.addEventListener("load",(()=>{window.scrollTo(0,0),n()})),window.addEventListener("scroll",(function(){const t=window.pageYOffset;t>40?(e.body.classList.add("isScrolling"),t>500?e.btnUp.classList.remove("isHidden"):t<=500&&e.btnUp.classList.add("isHidden")):t<=40&&e.body.classList.remove("isScrolling")})),e.btnUp.addEventListener("click",(function(){window.scrollTo(0,0)}));async function a(e,t=1,n,a){let i,s="";const o=t?`&page=${t}`:"";switch(e){case"search":i="search/movie",s=`&query=${n}`;break;case"details":i=`movie/${a}`;break;case"video":i=`movie/${a}/videos`;break;case"cast":i=`movie/${a}/credits`;break;case"reviews":i=`movie/${a}/reviews`;break;case"trend":i="trending/all/week";break;case"genres":i="genre/movie/list";break;default:console.log("Invalid typeOfQuery")}const r=await fetch(`https://api.themoviedb.org/3/${i}?api_key=9cb79068ade378f45d510f1b7326cccd${s}${o}`);return await r.json()}function i(e){const{id:t,movieTitle:n,movieImg:a,releaseYear:i,genresNamesList:s}=e;return`\n    <li class="movie-card animate__animated animate__zoomIn">\n      <img\n        class="movie-card__img"\n        src=${a}\n        alt=${n}\n        width="300"\n        height="450"\n      />\n      <div class="movie-card__desc">\n        <p class="movie-card__title">${n}</p>\n        <p class="movie-details__genres">${s}</p>\n        <p class="movie-card__year">${i}</p>\n      </div>\n      <button type="button" class="movie-card__details-btn" data-id=${t} aria-label="to open movie details"></button>\n    </li>\n  `}function s(e,t){const{id:n,movieTitle:a,movieImg:i,releaseYear:s,genresNamesList:o}=e;return`\n    <div class="movie-details animate__animated animate__zoomIn">\n      <img\n        class="movie-details__img"\n        src=${i}\n        alt=${a}\n      \n      />\n      <div class="movie-details__desc">\n        <p class="movie-details__title">${a}</p>\n        <p class="movie-details__desc-row movie-details__genres"><span>Genre</span>${o}</p>\n        <p class="movie-details__desc-row movie-details__year"><span>Year</span>${s}</p>\n        <button type="button" class="movie-details__video-play-btn" data-id=${n} aria-label="to open movie details">Show official trailer</button>\n      </div>\n      <div class="movie-details__video isHidden">${t?` <iframe\n          src="https://www.youtube.com/embed/${t}?cc_load_policy=1?rel=0&showinfo=0&autoplay=1"\n          title="YouTube video player"\n          frameborder="0"\n          allow="accelerometer; clipboard-write; encrypted-media; gyroscope; picture-in-picture;"\n          allowfullscreen\n          autoplay="0"\n        ></iframe>`:""}</div>\n    </div>\n  `}function o(e){let t="";return 1===e&&(t="current"),`\n    <button class="paginationBtn ${t}" data-page="${e}" aria-label="to open page number ${e}">${e}</button>\n  `}function r(e){return e?e.target.dataset.page:1}function d(e){if(e<2)return"";let t=[];for(let n=0;n<e;n+=1)t.push(n+1);return t.map((e=>o(e))).join("")}function l(e){const t=r(e);console.log(t)}const c=e.modal.parentElement;function m(e){e.currentTarget===e.target&&v()}function u(e){c.classList.contains("isHidden")||"Escape"===e.code&&v()}function v(){c.classList.add("isHidden"),e.body.classList.remove("modalIsOpen"),e.modal.innerHTML="",c.removeEventListener("click",m),window.removeEventListener("keydown",u),e.modalCloseBtn.removeEventListener("click",v)}function p(e,t){const n=document.querySelector(`${t}[disabled]`);n&&(n.disabled=!1),e.target.disabled=!0}function g(e,t){const n=document.querySelector(t);n&&n.classList.remove("current"),e.target.classList.add("current")}e.searchForm.addEventListener("submit",(async function(t){t.preventDefault();const n=t.target.elements.searchQuery.value;if(!n)return;const i=await a("search",null,n,null);e.pagination.setAttribute("data-case","search"),e.pagination.setAttribute("data-query",n),y(i.results),w(i.total_pages)})),e.btnToTrends.addEventListener("click",(async function(){e.pagination.setAttribute("data-case","trend"),e.pagination.removeAttribute("data-query");const t=await a("trend");y(t.results),w(t.total_pages)}));let _=null;function f(t){e.modal.querySelector(".movie-details__video").classList.toggle("isHidden"),"Show official trailer"===t.target.textContent?t.target.textContent="Hide official trailer":t.target.textContent="Show official trailer"}function b(e){return e.map((e=>{const{id:t,name:n,title:a,genre_ids:i,poster_path:s,release_date:o,first_air_date:r}=e,d=a||n,l=i.map((e=>_.find((t=>e===t.id))?.name)).filter((e=>void 0!==e)).join(", ");const c=o||r;return{id:t,movieTitle:d,movieImg:s?`https://image.tmdb.org/t/p/w500${s}`:"./images/coming_soon.webp",releaseYear:c?c.slice(0,4):"",genresNamesList:l}}))}function y(t){const n=b(t),a=(s=n,o=i,!Array.isArray(s)||!s.length>0?"Нажаль данні не завантажились( Спробуйте пізніше":s.map((e=>o(e))).join(""));var s,o;e.moviesList.innerHTML=a}async function w(t){if(!t||t<2)return e.pagination.innerHTML="";e.pagination.innerHTML=d(t)}!async function(){_=await async function(){return(await a("genres")).genres}();const t=await a("trend");e.pagination.setAttribute("data-case","trend"),y(t.results),w(t.total_pages)}(),e.moviesList.addEventListener("click",(async function(i){if(!i.target.classList.contains("movie-card__details-btn"))return;t();const o=i.target.dataset.id,r=await a("details",null,null,o).then((e=>e.status?e:null)),d=r?function(e,t){const n=e.target.parentElement.querySelector(".movie-card__title").textContent,{name:a,title:i}=t;return n===(i||a)}(i,r):null;if(r&&d){const t=function(e){const{id:t,name:n,title:a,genres:i,poster_path:s,release_date:o,firstDate:r}=e,d=a||n,l=i?.map((e=>e.name)).join(", "),c=s?`https://image.tmdb.org/t/p/w500${s}`:"./images/coming_soon.webp",m=o||r,u=m?m.slice(0,4):"";return{id:t,movieTitle:d,movieImg:c,releaseYear:u,genresNamesList:l}}(r),n=a("video",null,null,o),i=await async function(e){const{results:t}=await e;if(!t||t.length<1)return null;const n=t.find((e=>"official trailer"===e.name.toLowerCase())),a=t.find((e=>e.name.toLowerCase().includes("trailer"))),i=t[0];return n?.key||a?.key||i?.key}(n),d=s(t,i);e.modal.innerHTML=d;const l=e.modal.querySelector(".movie-details__video-play-btn");i?l.addEventListener("click",f):l.classList.add("isHidden")}else{const t='\n    <div class="movie-details animate__animated animate__zoomIn">\n      <img\n        class="movie-details__img"\n        src=\'./images/coming_soon.webp\'\n        alt=\'Error image\'\n      />\n      <div class="movie-details__desc">\n        <p class="movie-details__title">Ooops! Sorry, but we dont find information</p>\n      </div>\n    </div>\n  ';e.modal.innerHTML=t}c.classList.remove("isHidden"),e.body.classList.add("modalIsOpen"),c.addEventListener("click",m),window.addEventListener("keydown",u),e.modalCloseBtn.addEventListener("click",v),n()})),e.pagination?.addEventListener("click",(async function(i){if("BUTTON"!==i.target.nodeName)return;t();const s=r(i),o=e.pagination.dataset.case,d=e.pagination.dataset.query;y((await a(o,s,d)).results),l(i),p(i,".paginationBtn"),g(i,".paginationBtn.current"),n()}));
//# sourceMappingURL=index.8399cc56.js.map
