var e={body:document.querySelector("body"),header:document.querySelector("header"),loader:document.querySelector(".loader"),modal:document.querySelector(".modal"),modalCloseBtn:document.querySelector(".backdrop .modal__close-btn"),pagination:document.querySelector("div.pagination"),btnUp:document.querySelector(".btn-up"),searchForm:document.querySelector("form.search-form"),btnToTrends:document.querySelector("form .trends"),moviesList:document.querySelector(".movies__list")};function t(){e.body.classList.add("isLoading"),e.loader.parentElement.classList.remove("isHidden")}function n(){e.body.classList.remove("isLoading"),e.loader.parentElement.classList.add("isHidden")}window.addEventListener("load",(()=>{window.scrollTo(0,0),n()})),window.addEventListener("scroll",(function(){const t=window.pageYOffset;t>40?(e.body.classList.add("isScrolling"),t>500?e.btnUp.classList.remove("isHidden"):t<=500&&e.btnUp.classList.add("isHidden")):t<=40&&e.body.classList.remove("isScrolling")})),e.btnUp.addEventListener("click",(function(){window.scrollTo(0,0)}));async function a(e,t=1,n,a){let i,s="";const o=t?`&page=${t}`:"";switch(e){case"search":i="search/movie",s=`&query=${n}`;break;case"details":i=`movie/${a}`;break;case"video":i=`movie/${a}/videos`;break;case"cast":i=`movie/${a}/credits`;break;case"reviews":i=`movie/${a}/reviews`;break;case"trend":i="trending/all/week";break;case"genres":i="genre/movie/list";break;default:console.log("Invalid type of query")}const d=await fetch(`https://api.themoviedb.org/3/${i}?api_key=9cb79068ade378f45d510f1b7326cccd${s}${o}`);return await d.json()}function i(e){const{id:t,movieTitle:n,movieImg:a,releaseYear:i,genresNamesList:s}=e;return`\n    <li class="movie-card animate__animated animate__zoomIn">\n      <img\n        class="movie-card__img"\n        src=${a}\n        alt=${n}\n        width="300"\n        height="450"\n      />\n      <div class="movie-card__desc">\n        <div class="movie-card__title-wrap">\n          <span class="movie-card__title">${n}</span>\n          <span class="movie-card__year">(${i})</span>\n        </div>\n        <p class="movie-card__ganres">${s}</p>\n      </div>\n      <button type="button" class="movie-card__details-btn" data-id=${t} aria-label="to open movie details"></button>\n    </li>\n  `}function s(e,t){const{id:n,movieTitle:a,movieImg:i,releaseYear:s,genresNamesList:o,vote:d,vote_count:r,overview:l}=e;return`\n    <div class="movie-details animate__animated animate__zoomIn">\n      <img\n        class="movie-details__img"\n        src=${i}\n        alt=${a}\n      />\n      <div class="movie-details__desc">\n        <p class="movie-details__title">${a} <span>(${s})</span></p>\n        <ul class="movie-details__desc-list">\n          <li class="movie-details__desc-item">\n            <span class="movie-details__desc-label">Vote / Votes:</span><span class="movie-details__desc-info"><span>${d}</span> / <span>${r}</span></span>\n          </li>\n          <li class="movie-details__desc-item">\n            <span class="movie-details__desc-label">Genres:</span><span class="movie-details__desc-info">${o}</span>\n          </li>\n           <li class="movie-details__desc-item">\n            <span class="movie-details__desc-label">About:</span>\n          </li>\n        </ul>\n        <span class="movie-details__desc-info">${l}</span>\n        <ul class="movie-details__btns-list">\n          <li class="movie-details__btns-item">\n              <button type="button" class="movie-details__queue-btn movie-details__btns" data-id=${n} aria-label="to open movie details">Add to queue</button>\n            </li>\n          <li class="movie-details__btns-item">\n            <button type="button" class="movie-details__watched-btn movie-details__btns" data-id=${n} aria-label="to open movie details">Add to watched</button>\n          </li>\n          <li class="movie-details__btns-item">\n            <button type="button" class="movie-details__video-play-btn movie-details__btns" data-id=${n} aria-label="to open movie details">Show trailer</button>\n          </li>\n        </ul>\n\n\n      </div>\n      <div class="movie-details__video isHidden">${t?` <iframe\n          src="https://www.youtube.com/embed/${t}?cc_load_policy=1?rel=0&showinfo=0&autoplay=1"\n          title="YouTube video player"\n          frameborder="0"\n          allow="accelerometer; clipboard-write; encrypted-media; gyroscope; picture-in-picture;"\n          allowfullscreen\n          autoplay="0"\n        ></iframe>`:""}</div>\n    </div>\n  `}function o(e,t){e.classList.add(t)}function d(e,t){e.classList.remove(t)}function r(t){if(!t)return"1";let n="1";return n="next"===t.target.dataset.page?String(Number(e.pagination.dataset.currentpage)+1):"prev"===t.target.dataset.page?String(Number(e.pagination.dataset.currentpage)-1):t.target.dataset.page,n}async function l(t){if(!t||t<2)return e.pagination.innerHTML="";e.pagination.innerHTML=function(e){if(e<2)return"";let t=[];for(let n=0;n<e;n+=1)t.push(n+1);t.splice(1,0,"..."),t.splice(t.length-1,0,"..."),t.unshift("prev"),t.push("next");const n=t.length-4;return t.map((e=>function(e,t){let n="",a="";switch(e>7&&(a="isHidden"),e){case 1:n=`<button class="paginationBtn current" data-page="${e}" aria-label="to open page number ${e}" disabled>${e}</button>`;break;case t:n=`<button class="paginationBtn" data-page="${e}" aria-label="to open page number ${e}">${e}</button>`;break;case"...":n=`<button class="paginationBtn__extra paginationBtn__extra--decor isHidden" data-page="${e}" aria-label="decoration" disabled>${e}</button>`;break;case"prev":n=`<button class="paginationBtn__extra paginationBtn__extra--arrov isHidden" data-page="${e}" aria-label="to open previous page">${e}</button>`;break;case"next":n=`<button class="paginationBtn__extra paginationBtn__extra--arrov" data-page="${e}" aria-label="to open next page">${e}</button>`;break;default:n=`<button class="paginationBtn ${a}" data-page="${e}" aria-label="to open page number ${e}">${e}</button>`}return n}(e,n))).join("")}(t)}function c(t){const n=e.pagination.querySelectorAll(".paginationBtn"),a=e.pagination.querySelectorAll(".paginationBtn__extra"),i=n.length;let s=1,r=7;switch(t>i-3?(s=i-6,r=i):t>4&&(s=t-3,r=t+3),t){case 1:for(const e of n){const t=Number(e.dataset.page);1!==t&&t!==i&&(t<=r?d(e,"isHidden"):o(e,"isHidden"))}o(a[0],"isHidden"),o(a[1],"isHidden"),d(a[2],"isHidden"),d(a[3],"isHidden");break;case 6:for(const e of n){const t=Number(e.dataset.page);1!==t&&t!==i&&(t<=r?d(e,"isHidden"):o(e,"isHidden"))}d(a[0],"isHidden"),o(a[1],"isHidden"),d(a[2],"isHidden"),d(a[3],"isHidden");break;case i-5:for(const e of n){const t=Number(e.dataset.page);1!==t&&t!==i&&(t>=s?d(e,"isHidden"):o(e,"isHidden"))}console.log(s),d(a[0],"isHidden"),d(a[1],"isHidden"),o(a[2],"isHidden"),d(a[3],"isHidden");break;case i:for(const e of n){const t=Number(e.dataset.page);1!==t&&t!==i&&(t>=s?d(e,"isHidden"):o(e,"isHidden"))}d(a[0],"isHidden"),d(a[1],"isHidden"),o(a[2],"isHidden"),o(a[3],"isHidden");break;default:for(const e of n){const t=Number(e.dataset.page);1!==t&&t!==i&&(t<s||t>r?o(e,"isHidden"):d(e,"isHidden"))}d(a[0],"isHidden"),d(a[3],"isHidden"),t>5&&d(a[1],"isHidden"),t<=5&&o(a[1],"isHidden"),t<=i-5&&d(a[2],"isHidden")}}const u=e.modal.parentElement;function m(e){e.currentTarget===e.target&&v()}function p(e){u.classList.contains("isHidden")||"Escape"===e.code&&v()}function v(){u.classList.add("isHidden"),e.body.classList.remove("modalIsOpen"),e.modal.innerHTML="",u.removeEventListener("click",m),window.removeEventListener("keydown",p),e.modalCloseBtn.removeEventListener("click",v)}function g(e,t,n){const a=document.querySelector(`${e}[disabled]`);if(a&&(a.disabled=!1),t){document.querySelector(`[data-page='${t}']`).disabled=!0}else n.target.disabled=!0}function _(e,t,n){const a=document.querySelector(e);if(a&&a.classList.remove("current"),t){document.querySelector(`[data-page='${t}']`).classList.add("current")}else n.target.classList.add("current")}e.searchForm.addEventListener("submit",(async function(t){t.preventDefault();const n=t.target.elements.searchQuery.value;if(!n)return;const i=await a("search",null,n,null);e.pagination.setAttribute("data-type","search"),e.pagination.setAttribute("data-query",n),w(i.results),l(i.total_pages),c(),t.target.reset()})),e.btnToTrends.addEventListener("click",(async function(){e.pagination.setAttribute("data-type","trend"),e.pagination.removeAttribute("data-query");const t=await a("trend");w(t.results),l(t.total_pages)}));let b=null;function f(t){e.modal.querySelector(".movie-details__video").classList.toggle("isHidden"),"Show trailer"===t.target.textContent?t.target.textContent="Hide trailer":t.target.textContent="Show trailer"}function y(e){return e.map((e=>{const{id:t,name:n,title:a,genre_ids:i,poster_path:s,release_date:o,first_air_date:d}=e,r=a||n,l=(c=i)&&c.length?c.map((e=>b.find((t=>e===t.id))?.name)).filter((e=>void 0!==e)).join(", "):"Other";var c;const u=o||d;return{id:t,movieTitle:r,movieImg:s?`https://image.tmdb.org/t/p/w500${s}`:"./images/coming_soon.webp",releaseYear:u?u.slice(0,4):"",genresNamesList:l}}))}function w(t){const n=y(t),a=(s=n,o=i,!Array.isArray(s)||!s.length>0?"Нажаль данні не завантажились( Спробуйте пізніше":s.map((e=>o(e))).join(""));var s,o;e.moviesList.innerHTML=a}!async function(){b=await async function(){return(await a("genres")).genres}();const t=await a("trend");t.total_pages>50&&(t.total_pages=50);w(t.results),l(t.total_pages),c(1),e.pagination.setAttribute("data-type","trend"),e.pagination.setAttribute("data-currentpage",1)}(),e.moviesList.addEventListener("click",(async function(i){if(!i.target.classList.contains("movie-card__details-btn"))return;t();const o=i.target.dataset.id,d=await a("details",null,null,o).then((e=>e.status?e:null)),r=d?function(e,t){const n=e.target.parentElement.querySelector(".movie-card__title").textContent,{name:a,title:i}=t;return n===(i||a)}(i,d):null;if(d&&r){const t=function(e){const{id:t,name:n,title:a,genres:i,poster_path:s,release_date:o,firstDate:d,vote_average:r,vote_count:l,overview:c}=e,u=a||n,m=i?.map((e=>e.name)).join(", "),p=s?`https://image.tmdb.org/t/p/w500${s}`:"./images/coming_soon.webp",v=o||d,g=v?v.slice(0,4):"",_=r.toFixed(1);return{id:t,movieTitle:u,movieImg:p,releaseYear:g,genresNamesList:m,vote:_,vote_count:l,overview:c}}(d),n=a("video",null,null,o),i=await async function(e){const{results:t}=await e;if(!t||t.length<1)return null;const n=t.find((e=>"official trailer"===e.name.toLowerCase())),a=t.find((e=>e.name.toLowerCase().includes("trailer"))),i=t[0];return n?.key||a?.key||i?.key}(n),r=s(t,i);e.modal.innerHTML=r;const l=e.modal.querySelector(".movie-details__video-play-btn");i?l.addEventListener("click",f):l.classList.add("isHidden")}else{const t='\n    <div class="movie-details animate__animated animate__zoomIn">\n      <img\n        class="movie-details__img"\n        src=\'./images/coming_soon.webp\'\n        alt=\'Error image\'\n      />\n      <div class="movie-details__desc">\n        <p class="movie-details__title">Ooops! Sorry, but we dont find information</p>\n      </div>\n    </div>\n  ';e.modal.innerHTML=t}u.classList.remove("isHidden"),e.body.classList.add("modalIsOpen"),u.addEventListener("click",m),window.addEventListener("keydown",p),e.modalCloseBtn.addEventListener("click",v),n()})),e.pagination?.addEventListener("click",(async function(i){if("BUTTON"!==i.target.nodeName)return;t();const s=r(i),o=e.pagination.dataset.type,d=e.pagination.dataset.query;w((await a(o,s,d)).results),c(Number(s)),g(".paginationBtn",s,i),_(".paginationBtn.current",s,i),e.pagination.setAttribute("data-currentpage",s),n()}));
//# sourceMappingURL=index.70ea50a6.js.map
